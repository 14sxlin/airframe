<html><head><title>Airframe: DI Framework Comparison</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Taro L. Saito" /><meta name="description" content="Lightweight Building Blocks for Scala" /><meta name="og:image" content="/airframe/img/poster.png" /><meta name="og:title" content="Airframe: DI Framework Comparison" /><meta name="og:site_name" content="Airframe" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Lightweight Building Blocks for Scala" /><link rel="icon" type="image/png" href="/airframe/img/favicon.png" /><meta name="twitter:title" content="Airframe: DI Framework Comparison" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Lightweight Building Blocks for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/airframe/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/airframe/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/airframe/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/airframe/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/airframe/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/airframe/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/airframe/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/airframe/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/airframe/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/airframe/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/airframe/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/airframe/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/airframe/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/airframe/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/airframe/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/airframe/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/airframe/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/airframe/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/airframe/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/airframe/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/airframe/highlight/styles/ocean.css" /><link rel="stylesheet" href="/airframe/css/style.css" /><link rel="stylesheet" href="/airframe/css/palette.css" /><link rel="stylesheet" href="/airframe/css/codemirror.css" /><link rel="stylesheet" href="/airframe/css/overwrite.css" /><link rel="stylesheet" href="/airframe/css/solarized-dark.css" /><script async="async">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-98364158-1' , 'auto');
ga('send', 'pageview');
      </script></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/airframe/" class="brand"><div class="brand-wrapper"><span>Airframe</span></div></a></li> <li><a href="/airframe/docs/index.html" class="">Quick Start</a> <ul class="sub_section"> <li><a href="/airframe/docs/index.html#bind" class="">Bind</a></li> <li><a href="/airframe/docs/index.html#design" class="">Design</a></li> <li><a href="/airframe/docs/index.html#session" class="">Session</a></li> <li><a href="/airframe/docs/index.html#life-cycle" class="">Life Cycle</a></li></ul></li> <li><a href="/airframe/docs/use-cases.html" class="">Use Cases</a></li> <li><a href="/airframe/docs/bindings.html" class="">Advanced Binding Types</a></li> <li><a href="/airframe/docs/debug.html" class="">Debugging DI</a></li> <li><a href="/airframe/docs/comparison.html" class="">Other DI Frameworks</a></li> <li><a href="/airframe/docs/utils.html" class="">Airframe Utilities</a> <ul class="sub_section"> <li><a href="/airframe/docs/airframe-log.html" class="">airframe-log</a></li> <li><a href="/airframe/docs/airframe-codec.html" class="">airframe-codec</a></li> <li><a href="/airframe/docs/airframe-config.html" class="">airframe-config</a></li> <li><a href="/airframe/docs/airframe-opts.html" class="">airframe-opts</a></li> <li><a href="/airframe/docs/airframe-metrics.html" class="">airframe-metrics</a></li> <li><a href="/airframe/docs/airframe-jdbc.html" class="">airframe-jdbc</a></li> <li><a href="/airframe/docs/airframe-jmx.html" class="">airframe-jmx</a></li> <li><a href="/airframe/docs/airframe-surface.html" class="">airframe-surface</a></li></ul></li> <li><a href="/airframe/docs/internals.html" class="">Airframe Internals</a></li> <li><a href="/airframe/docs/release-notes.html" class="">Release Notes</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/wvlet/airframe"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/wvlet/airframe"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Airframe Lightweight Building Blocks for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Airframe Lightweight Building Blocks for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="wvlet" data-github-repo="airframe"><div class="content-wrapper"><section><h1 id="di-framework-comparison">DI Framework Comparison</h1>

<p>There are two types of dependency injection approaches; <strong>runtime</strong> and <strong>compile-time</strong> (static) DIs.</p>

<h2 id="run-time-dependency-injection">Run-time Dependency Injection</h2>

<ul>
  <li><a href="https://github.com/google/guice">Google Guice</a> is a popular run-time dependency injection libraries in Java, which is also used in <a href="https://github.com/prestodb/presto">Presto</a> to construct a distributed SQL engine consisting of hundreds of classes. Guice itself does not manage the lifecycle of objects and binding configurations, so Presto team at Facebook has developed <a href="https://github.com/airlift/airlift/tree/master/bootstrap/src/main/java/io/airlift/bootstrap">airlift-bootstrap</a> and <a href="https://github.com/airlift/airlift/tree/master/configuration/src/main/java/io/airlift/configuration">airlift- configuration</a> libraries to extend Guiceâ€™s functionality.
    <ul>
      <li>One of the disadvantages of Guice is it requires constructor annotation like <code class="highlighter-rouge">@Inject</code>. This is less convenient if you are using third-party libraries, which cannot add such annotations. So you often need to write many provider binding modules to use third-party classes.</li>
      <li>Airframe has provider bindings in <code class="highlighter-rouge">bind { d1: D1 =&gt; new X(d1) }</code> syntax so that you can directly call the constructor of third-party classes. No need to implement object binding modules.</li>
    </ul>
  </li>
  <li>
    <p><a href="https://github.com/scaldi/scaldi">Scaldi</a> is an early adaptor of Guice like DI for Scala and has implemented all of the major functionalities of Guice. However it requires extending your class with Scaldi <code class="highlighter-rouge">Module</code>. Airframe is simplifying it so that you only need to use <code class="highlighter-rouge">bind[X]</code> without extending any trait.</p>
  </li>
  <li>
    <p><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html">Spring IoC container</a> Spring framework popularized the notion of <a href="https://martinfowler.com/articles/injection.html">Inversion of Control</a>, which is now simply called DI. Spring uses XML based configuration, which is less programmer-friendly, but it has been useful to manage ordering of object initializations outside the program.</p>
  </li>
  <li><a href="http://weld.cdi-spec.org/">Weld</a> is a reference implementation of <a href="http://cdi-spec.org/">Contexts &amp; Dependency Injection for Java (CDP)</a> specifications for managing object life cycle and DI for Java EE applications. Weld, for example, has HTTP request scoped object life cycle, annotations for describing how to inject dependencies, etc.</li>
</ul>

<h2 id="compile-time-dependency-injection">Compile-time Dependency Injection</h2>

<ul>
  <li>
    <p><a href="https://github.com/adamw/macwire">MacWire</a> is a compile-time dependency injection library for Scala using <code class="highlighter-rouge">wire[A]</code> syntax.
MacWire ensures all binding types are available at compile time, so if some dependency is missing, it will be shown as a compile error. That is a major advantage of MacWire. On the other hand it sacrifices dynamic binding; For example, we cannot switch the implementation of <code class="highlighter-rouge">wire[A]</code> to <code class="highlighter-rouge">class AImpl(d1:D1, d2:D2, d3:D3) extends A</code>, because we cannot statically resolve dependencies from A to D1, D2, and D3 at compile time. And also for implementing lifecycle management like <code class="highlighter-rouge">onStart</code> and <code class="highlighter-rouge">onShutdown</code> hooks, MacWire needs to implement <a href="https://github.com/adamw/macwire#interceptors">interceptors</a>. This requires <a href="http://jboss-javassist.github.io/javassist/">Javassist</a> library and doesnâ€™t work in Scala.js.</p>
  </li>
  <li>
    <p><a href="https://github.com/google/dagger">Dagger2</a> is also a compile-time dependency injection library for Java and Android. Google needed binding hundreds of modules, but Guice only resolves these dependencies at runtime, so binding failures can be found later when the application is running. To resolve this, Dagger2 tries to generate dependency injection code at compile time. <a href="https://google.github.io/dagger/users-guide">This document</a> is a good read to understand the background of why compile-time DI was necessary.</p>
  </li>
</ul>

<p>Both of MacWire and Dagger2 requires all of the dependencies should be found in the same scope. There are pros and cons in this approach; A complex example is <a href="https://github.com/guardian/frontend">Guardian</a>â€™s <a href="https://github.com/guardian/frontend/blob/06b94f88593e68682fb2a03c6d878947f8472d44/admin/app/controllers/AdminControllers.scala">frontend code</a>, which lists 30 dependencies, including transitive dependenceis, in a single trait to resolve dependencies at compile time. In runtime DI, we only need to write direct dependencies.</p>

<h2 id="summary">Summary</h2>

<ul>
  <li>Compile-time dependency injection:
    <ul>
      <li>libraries: Macwire, Dagger2, etc.</li>
      <li><strong>pros</strong>: Can validate the presence of dependencies at compile time.</li>
      <li><strong>cons</strong>: Less flexible (e.g., No dynamic type binding)</li>
      <li><strong>cons</strong>: Need to enumerate all dependencies in the same scope (lengthy code).</li>
      <li><strong>cons</strong>: Hard to implement life cycle management (e.g., onStart, onShutdown, etc.).</li>
    </ul>
  </li>
  <li>Run-time dependency injection
    <ul>
      <li>libraries: Airframe, Google Guice, etc.</li>
      <li><strong>pros</strong>: Allows dynamic type binding.</li>
      <li><strong>pros</strong>: Simpler binding codes. Only need to bind direct dependencies.</li>
      <li><strong>pros</strong>: Can customize object life cycle events through session (Airframe)or inject event handler (Guice).</li>
      <li><strong>cons</strong>: Missed binding founds as a runtime error.</li>
    </ul>
  </li>
</ul>

<p>Airframe belongs to a runtime dependency injection library, and resolves several short-comings of Google Guice (lack of lifecycle manager, difficulty of binding third-party objects, etc.). We also have implemented Scala-friendly DI syntax in Airframe. For the performance reason, Airframe uses Scala macros to generate binding code as much as possible (except dynamic type binding, which cannot be found at compile-time). To use Airframe, you donâ€™t need to understand the whole concept of DI and features in the existing DI frameworks. Just <code class="highlighter-rouge">bind</code>-<code class="highlighter-rouge">design</code>-<code class="highlighter-rouge">build</code> objects. That is all you need to know!</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/airframe/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'wvlet/airframe'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/airframe/js/main.js"></script></body></html>